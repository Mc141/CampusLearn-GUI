<Page
    x:Class="CampusLearn.Presentation.CreateTopicPage"
    x:Name="RootPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:utu="using:Uno.Toolkit.UI"
    utu:StatusBar.Foreground="Auto"
    Background="{ThemeResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Header -->
            <RowDefinition Height="*"/>    <!-- Main content -->
        </Grid.RowDefinitions>

        <!-- ========== HEADER ========== -->
        <Grid Grid.Row="0"
              Padding="20,16"
              Background="{ThemeResource SurfaceBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Back Button -->
            <Button
                Width="40"
                Height="40"
                Padding="0"
                Background="Transparent"
                BorderThickness="0"
                Command="{Binding NavigateBackCommand}">
                <Border
                    Width="40"
                    Height="40"
                    CornerRadius="20"
                    Background="#E8DEF8"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                    <FontIcon
                        Glyph="&#xE72B;"
                        FontFamily="Segoe MDL2 Assets"
                        Foreground="#6750A4"
                        FontSize="18"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"/>
                </Border>
            </Button>

            <!-- CampusLearn logo -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="Campus" FontSize="24" FontWeight="Bold"
                           Foreground="{ThemeResource OnSurfaceBrush}"/>
                <TextBlock Text="Learn" FontSize="24" FontWeight="Bold"
                           Foreground="#FFC107"/>
                <TextBlock Text="™" FontSize="14" FontWeight="Bold"
                           Foreground="#FFC107" VerticalAlignment="Top" Margin="2,0,0,0"/>
            </StackPanel>

            <!-- Create Button -->
            <Button Grid.Column="2"
                    Content="Create"
                    Padding="16,8"
                    Background="#6750A4"
                    Foreground="White"
                    BorderThickness="0"
                    CornerRadius="20"
                    FontWeight="SemiBold"
                    Command="{Binding CreateTopicCommand}"/>
        </Grid>

        <!-- ========== MAIN CONTENT ========== -->
        <ScrollViewer Grid.Row="1" Padding="20,16" VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="20" MaxWidth="700" HorizontalAlignment="Center">

                <!-- Title -->
                <TextBlock Text="Create Help Topic"
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{ThemeResource OnSurfaceBrush}"/>

                <!-- Subtitle -->
                <TextBlock Text="Get help from tutors by creating a new topic. Select your module and describe what you need assistance with."
                           FontSize="14"
                           Foreground="#49454F"
                           TextWrapping="Wrap"/>

                <!-- Divider -->
                <Rectangle Height="1"
                           Fill="{ThemeResource OutlineBrush}"
                           Margin="0,8"/>

                <!-- Module Selection -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Module / Course *"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <ComboBox SelectedIndex="{Binding SelectedModuleIndex, Mode=TwoWay}"
                              ItemsSource="{Binding AvailableModules}"
                              PlaceholderText="Select a module"
                              FontSize="15"
                              HorizontalAlignment="Stretch"
                              CornerRadius="8">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock FontSize="15" FontWeight="SemiBold">
                                        <Run Text="{Binding Code}"/>
                                    </TextBlock>
                                    <TextBlock Text="{Binding Name}"
                                               FontSize="13"
                                               Foreground="#49454F"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <!-- Topic Title -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Topic Title *"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <TextBox Text="{Binding TopicTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             PlaceholderText="e.g., Need help with SQL JOIN operations"
                             FontSize="15"
                             BorderBrush="{ThemeResource OutlineBrush}"
                             CornerRadius="8"
                             Padding="12"
                             MaxLength="150"/>
                </StackPanel>

                <!-- Description -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Description *"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <TextBox Text="{Binding TopicDescription, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             PlaceholderText="Describe what specific help you need..."
                             FontSize="15"
                             BorderBrush="{ThemeResource OutlineBrush}"
                             CornerRadius="8"
                             Padding="12"
                             MinHeight="120"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"/>
                </StackPanel>

                <!-- Difficulty Level -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Difficulty Level"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <ComboBox SelectedIndex="{Binding SelectedDifficultyIndex, Mode=TwoWay}"
                              FontSize="15"
                              HorizontalAlignment="Stretch"
                              CornerRadius="8">
                        <ComboBoxItem Content="Beginner"/>
                        <ComboBoxItem Content="Intermediate"/>
                        <ComboBoxItem Content="Advanced"/>
                    </ComboBox>
                </StackPanel>

                <!-- Info Box -->
                <Border Background="#E3F2FD"
                        BorderBrush="#2196F3"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,8,0,0">
                    <StackPanel Spacing="8">
                        <TextBlock Text="💡 What happens next?"
                                   FontSize="15"
                                   FontWeight="SemiBold"
                                   Foreground="#1976D2"/>
                        <TextBlock Text="• Tutors registered for this module will be notified"
                                   FontSize="13"
                                   Foreground="#424242"/>
                        <TextBlock Text="• Other students can subscribe to your topic"
                                   FontSize="13"
                                   Foreground="#424242"/>
                        <TextBlock Text="• You'll receive updates when tutors respond"
                                   FontSize="13"
                                   Foreground="#424242"/>
                        <TextBlock Text="• Resources and discussions will be linked to this topic"
                                   FontSize="13"
                                   Foreground="#424242"/>
                    </StackPanel>
                </Border>

                <!-- Character Counter -->
                <TextBlock HorizontalAlignment="Right"
                           FontSize="13"
                           Foreground="#49454F">
                    <Run Text="{Binding TopicDescription.Length}"/>
                    <Run Text=" / 500 characters"/>
                </TextBlock>

                <Border Height="40"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
