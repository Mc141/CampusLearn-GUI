<Page
    x:Class="CampusLearn.Presentation.UploadResourcePage"
    x:Name="RootPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:utu="using:Uno.Toolkit.UI"
    utu:StatusBar.Foreground="Auto"
    Background="{ThemeResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Header -->
            <RowDefinition Height="*"/>    <!-- Main content -->
        </Grid.RowDefinitions>

        <!-- ========== HEADER ========== -->
        <Grid Grid.Row="0"
              Padding="20,16"
              Background="{ThemeResource SurfaceBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Back Button -->
            <Button
                Width="40"
                Height="40"
                Padding="0"
                Background="Transparent"
                BorderThickness="0"
                Command="{Binding NavigateBackCommand}">
                <Border
                    Width="40"
                    Height="40"
                    CornerRadius="20"
                    Background="#E8DEF8"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                    <FontIcon
                        Glyph="&#xE72B;"
                        FontFamily="Segoe MDL2 Assets"
                        Foreground="#6750A4"
                        FontSize="18"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"/>
                </Border>
            </Button>

            <!-- CampusLearn logo -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="Campus" FontSize="24" FontWeight="Bold"
                           Foreground="{ThemeResource OnSurfaceBrush}"/>
                <TextBlock Text="Learn" FontSize="24" FontWeight="Bold"
                           Foreground="#FFC107"/>
                <TextBlock Text="™" FontSize="14" FontWeight="Bold"
                           Foreground="#FFC107" VerticalAlignment="Top" Margin="2,0,0,0"/>
            </StackPanel>

            <!-- Upload Button -->
            <Button Grid.Column="2"
                    Content="Upload"
                    Padding="16,8"
                    Background="#6750A4"
                    Foreground="White"
                    BorderThickness="0"
                    CornerRadius="20"
                    FontWeight="SemiBold"
                    Command="{Binding UploadCommand}"/>
        </Grid>

        <!-- ========== MAIN CONTENT ========== -->
        <ScrollViewer Grid.Row="1" Padding="20,16" VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="20" MaxWidth="700" HorizontalAlignment="Center">

                <!-- Title -->
                <TextBlock Text="Upload Learning Resource"
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{ThemeResource OnSurfaceBrush}"/>

                <!-- Subtitle -->
                <TextBlock Text="Share study materials, notes, videos, and more with your peers"
                           FontSize="14"
                           Foreground="#49454F"
                           TextWrapping="Wrap"/>

                <!-- Divider -->
                <Rectangle Height="1"
                           Fill="{ThemeResource OutlineBrush}"
                           Margin="0,8"/>

                <!-- File Picker -->
                <Border BorderBrush="{ThemeResource OutlineBrush}"
                        BorderThickness="2"
                        CornerRadius="12"
                        Padding="24"
                        Background="#F7F2FA">
                    <StackPanel Spacing="12" HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE8B7;"
                                  FontFamily="Segoe MDL2 Assets"
                                  FontSize="48"
                                  Foreground="#6750A4"/>
                        <TextBlock Text="Click to select a file"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Foreground="{ThemeResource OnSurfaceBrush}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Supported: PDF, DOCX, PPTX, PNG, JPG, MP4, MP3"
                                   FontSize="13"
                                   Foreground="#757575"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Max file size: 10 MB"
                                   FontSize="12"
                                   Foreground="#757575"
                                   HorizontalAlignment="Center"/>
                        
                        <Button Content="Choose File"
                                Padding="20,10"
                                Margin="0,8,0,0"
                                Background="#6750A4"
                                Foreground="White"
                                BorderThickness="0"
                                CornerRadius="20"
                                FontWeight="SemiBold"
                                Command="{Binding PickFileCommand}"/>
                        
                        <!-- Selected File Display -->
                        <Border Background="White"
                                CornerRadius="8"
                                Padding="12"
                                Margin="0,8,0,0"
                                Visibility="{Binding HasSelectedFile, Converter={StaticResource BoolToVisibilityConverter}}">
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <Run Text="Selected: "/>
                                    <Run Text="{Binding SelectedFileName}"/>
                                </TextBlock>
                                <TextBlock Text="{Binding SelectedFileSize}"
                                           FontSize="12"
                                           Foreground="#757575"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Resource Title -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Title *"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <TextBox Text="{Binding ResourceTitle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             PlaceholderText="e.g., SQL Joins Study Guide"
                             FontSize="15"
                             BorderBrush="{ThemeResource OutlineBrush}"
                             CornerRadius="8"
                             Padding="12"
                             MaxLength="150"/>
                </StackPanel>

                <!-- Description -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Description"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <TextBox Text="{Binding ResourceDescription, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             PlaceholderText="Brief description of what this resource covers..."
                             FontSize="15"
                             BorderBrush="{ThemeResource OutlineBrush}"
                             CornerRadius="8"
                             Padding="12"
                             MinHeight="100"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"/>
                </StackPanel>

                <!-- Topic Selection -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Related Topic *"
                               FontSize="15"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource OnSurfaceBrush}"/>
                    <ComboBox SelectedIndex="{Binding SelectedTopicIndex, Mode=TwoWay}"
                              ItemsSource="{Binding AvailableTopics}"
                              PlaceholderText="Select a topic"
                              FontSize="15"
                              HorizontalAlignment="Stretch"
                              CornerRadius="8">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding TopicTitle}"
                                               FontSize="15"
                                               FontWeight="SemiBold"/>
                                    <TextBlock FontSize="13" Foreground="#757575">
                                        <Run Text="{Binding ModuleCode}"/>
                                        <Run Text=" - "/>
                                        <Run Text="{Binding ModuleName}"/>
                                    </TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <!-- Info Box -->
                <Border Background="#E3F2FD"
                        BorderBrush="#2196F3"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,8,0,0">
                    <StackPanel Spacing="8">
                        <TextBlock Text="📌 Upload Guidelines"
                                   FontSize="15"
                                   FontWeight="SemiBold"
                                   Foreground="#1976D2"/>
                        <TextBlock Text="• Ensure content is relevant and helpful"
                                   FontSize="13"
                                   Foreground="#424242"/>
                        <TextBlock Text="• No copyrighted material without permission"
                                   FontSize="13"
                                   Foreground="#424242"/>
                        <TextBlock Text="• Use clear, descriptive file names"
                                   FontSize="13"
                                   Foreground="#424242"/>
                        <TextBlock Text="• Your name will be shown as the uploader"
                                   FontSize="13"
                                   Foreground="#424242"/>
                    </StackPanel>
                </Border>

                <Border Height="40"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
